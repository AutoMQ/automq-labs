services:
  minio:
    image: minio/minio:latest
    command: server /data --console-address :9001
    environment:
      MINIO_ROOT_USER: minio
      MINIO_ROOT_PASSWORD: minio123
    ports: ["9000:9000","9001:9001"]
  
  automq:
    image: automqinc/automq:latest
    depends_on: [minio]
    environment:
      AWS_REGION: us-east-1
      AWS_ACCESS_KEY_ID: minio
      AWS_SECRET_ACCESS_KEY: minio123
      AWS_ENDPOINT_OVERRIDE: http://minio:9000
      AUTOMQ_CONFIG: /opt/automq/automq.properties
    volumes:
      - ./configs/automq.properties:/opt/automq/automq.properties:ro
    ports: ["9092:9092"]
  spark:
    image: apache/spark:3.5.0
    depends_on: [minio]
    environment:
      - SPARK_MODE=client
    volumes:
      - ./scripts:/workspace/scripts:ro
